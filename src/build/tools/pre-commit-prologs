#!/usr/bin/perl
# IBM_PROLOG_BEGIN_TAG
# This is an automatically generated prolog.
#
# $Source: src/build/tools/pre-commit-prologs $
#
# IBM CONFIDENTIAL
#
# COPYRIGHT International Business Machines Corp. 2011,2014
#
# p1
#
# Object Code Only (OCO) source materials
# Licensed Internal Code Source Materials
# IBM HostBoot Licensed Internal Code
#
# The source code for this program is not published or otherwise
# divested of its trade secrets, irrespective of what has been
# deposited with the U.S. Copyright Office.
#
# Origin: 30
#
# IBM_PROLOG_END_TAG

# This hook is used to add or update copyright prolog statements

my $script = "addCopyright.pl";

##  Make up a list of all staged files ( --cached --name-only )
##  Filter for only Added or Modified ( --diff-filter=AM )
chomp( my @fileList = `git diff --cached --name-only --diff-filter=AM` );

if ( @fileList )
{
    print "run $script update ...\n";
    print "        $_\n" foreach @fileList;
    print "\n";

    system "$ENV{'TOOLS_DIR'}/$script update @fileList";
    die("$?") if ($? != 0);

    system "git add @fileList";
    exit 1 if ($? != 0);
}

exit 0;
